import { Component } from '@angular/core';
import { MaterielService } from '../Services/materiel.service';
import { Materiel } from '../Models/materiel.model';
import { FormsModule } from '@angular/forms';
import { ButtonModule } from 'primeng/button';
import { InputTextModule } from 'primeng/inputtext';
import { DropdownModule } from 'primeng/dropdown';
import { CommonModule } from '@angular/common';
import { CreateMaterielDTO } from '../Dtos/materiel.dto';

@Component({
  selector: 'app-creation-materiels-masse',
  standalone: true,
  templateUrl: './creation-materiels-masse.component.html',
  styleUrls: ['./creation-materiels-masse.component.css'],
  imports: [FormsModule, ButtonModule, InputTextModule, DropdownModule, CommonModule]
})
export class CreationMaterielsMasseComponent {
  materiels: Partial<Materiel>[] = [{ nature: '', model: '' }];

  constructor(private materielService: MaterielService) {}

  ajouterLigne() {
    this.materiels.push({ nature: '', model: '' });
  }

  supprimerLigne(index: number) {
    this.materiels.splice(index, 1);
  }

  creerMateriels() {
    // Appel en masse, à adapter selon l'API backend
    this.materiels.forEach(m => {
      if (m.nature && m.model) {
        this.materielService.create(m as CreateMaterielDTO).subscribe();
      }
    });
    // Réinitialiser le formulaire ou afficher une notification
    this.materiels = [{ nature: '', model: '' }];
  }
} 